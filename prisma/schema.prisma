// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider  = "postgresql"
    url       = env("DATABASE_URL")
    directUrl = env("DIRECT_URL")
}


model Event {
    id          Int      @id @default(autoincrement())
    title       String
    description String?
    date        DateTime
    startTime   DateTime
    endTime     DateTime
    color       String?  
    
    createdAt   DateTime @default(now())
    updatedAt   DateTime @updatedAt

    organizerId String
    organizer   Profile @relation(fields: [organizerId], references: [userId], name: "Organizer")

    participants Participant[]

    @@index([date]) 
}

model Participant {
    id      Int     @id @default(autoincrement())
    userId  String
    eventId Int

    user    Profile @relation(fields: [userId], references: [userId])
    event   Event   @relation(fields: [eventId], references: [id])

    @@unique([userId, eventId]) // Ensures a user can't join the same event multiple times
}

model Profile {
    userId String @id

    email    String @unique
    username String @unique

    bio               String?
    profilePictureUrl String?

    eventsOrganized Event[] @relation("Organizer") 
    eventsJoined    Participant[]
}
